<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QAravan - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 5px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        .fixed { color: green; font-weight: bold; }
        .new { color: purple; font-weight: bold; }
        #search-input { width: 300px; padding: 10px; margin: 10px 0; }
        #results { margin-top: 10px; }
        .result-item { padding: 10px; margin: 5px 0; background: #f5f5f5; border-radius: 5px; }
        .device-info { background: #f0f8ff; padding: 10px; border-radius: 5px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>QAravan - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</h1>
    
    <div class="test-section">
        <h2>üéâ –°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π</h2>
        <div class="fixed">‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –±–æ–ª—å—à–µ –Ω–µ –ø—Ä–æ–≤–∞–ª–∏–≤–∞—é—Ç—Å—è –ø–æ–¥ —Å–µ—Ç–∫—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π</div>
        <div class="fixed">‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</div>
        <div class="fixed">‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —è–∑—ã–∫–∞ –≤–∏–¥–∏–º –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç</div>
        <div class="new">üÜï –ù–û–í–û–ï: –ü–æ–ª–Ω–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤</div>
        <div class="new">üÜï –ù–û–í–û–ï: –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Telegram WebApp</div>
        <div class="new">üÜï –ù–û–í–û–ï: –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –≤—ã–±–æ—Ä –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞</div>
        <div class="info">‚ÑπÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç AdaptiveSearchBar —Å —Ç—Ä–µ–º—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏:</div>
        <div class="info">&nbsp;&nbsp;&nbsp;‚Ä¢ PortalSearchBar –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞</div>
        <div class="info">&nbsp;&nbsp;&nbsp;‚Ä¢ MobileSearchBar –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö</div>
        <div class="info">&nbsp;&nbsp;&nbsp;‚Ä¢ Fallback –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏</div>
    </div>

    <div class="test-section">
        <h2>üì± –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ</h2>
        <div id="device-info" class="device-info">
            <div>–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ...</div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>–¢–µ—Å—Ç API</h2>
        <button onclick="testAPI()">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API /api/articles/ru</button>
        <div id="api-result"></div>
    </div>
    
    <div class="test-section">
        <h2>–¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞</h2>
        <input type="text" id="search-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞..." onkeyup="searchArticles()">
        <div id="search-status"></div>
        <div id="results"></div>
    </div>
    
    <div class="test-section">
        <h2>–¢–µ—Å—Ç —Ç–µ–º—ã</h2>
        <button onclick="toggleTheme()">–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É</button>
        <div id="theme-status"></div>
    </div>

    <script>
        let articles = [];
        
        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
        function showDeviceInfo() {
            const info = document.getElementById('device-info');
            const isMobile = window.innerWidth <= 768;
            const isTelegram = navigator.userAgent.toLowerCase().includes('telegram') || 
                             window.Telegram?.WebApp !== undefined ||
                             window.location.hostname.includes('telegram');
            
            info.innerHTML = `
                <strong>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:</strong><br>
                üì± –®–∏—Ä–∏–Ω–∞ —ç–∫—Ä–∞–Ω–∞: ${window.innerWidth}px x ${window.innerHeight}px<br>
                üì± –ú–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ${isMobile ? '–î–∞' : '–ù–µ—Ç'}<br>
                üì± Telegram WebApp: ${isTelegram ? '–î–∞' : '–ù–µ—Ç'}<br>
                üì± User Agent: ${navigator.userAgent}<br>
                <strong>–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–∏—Å–∫–∞:</strong><br>
                ${isMobile || isTelegram ? 'üîπ MobileSearchBar (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)' : 'üîπ PortalSearchBar (–¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞)'}
            `;
        }
        
        // –¢–µ—Å—Ç API
        async function testAPI() {
            const resultDiv = document.getElementById('api-result');
            try {
                const response = await fetch('/api/articles/ru');
                if (response.ok) {
                    const data = await response.json();
                    articles = data;
                    resultDiv.innerHTML = `<span class="success">‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç! –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${data.length} —Å—Ç–∞—Ç–µ–π</span>`;
                    console.log('Articles loaded:', data);
                } else {
                    resultDiv.innerHTML = `<span class="error">‚ùå –û—à–∏–±–∫–∞ API: ${response.status}</span>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<span class="error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</span>`;
            }
        }
        
        // –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞
        function searchArticles() {
            const query = document.getElementById('search-input').value;
            const statusDiv = document.getElementById('search-status');
            const resultsDiv = document.getElementById('results');
            
            if (!articles.length) {
                statusDiv.innerHTML = '<span class="error">–°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç–∞—Ç—å–∏ —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç API</span>';
                return;
            }
            
            if (query.length < 2) {
                statusDiv.innerHTML = '–í–≤–µ–¥–∏—Ç–µ –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞';
                resultsDiv.innerHTML = '';
                return;
            }
            
            const filtered = articles.filter(article => {
                return (
                    article.title.toLowerCase().includes(query.toLowerCase()) ||
                    article.tags.some(tag => tag.toLowerCase().includes(query.toLowerCase())) ||
                    article.category.toLowerCase().includes(query.toLowerCase())
                );
            }).slice(0, 5);
            
            statusDiv.innerHTML = `<span class="success">–ù–∞–π–¥–µ–Ω–æ: ${filtered.length} —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</span>`;
            
            resultsDiv.innerHTML = filtered.map(article => `
                <div class="result-item">
                    <strong>${article.title}</strong><br>
                    <small>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${article.category} | –¢–µ–≥–∏: ${article.tags.join(', ')}</small>
                </div>
            `).join('');
        }
        
        // –¢–µ—Å—Ç —Ç–µ–º—ã
        function toggleTheme() {
            const statusDiv = document.getElementById('theme-status');
            const isDark = document.documentElement.classList.contains('dark');
            
            if (isDark) {
                document.documentElement.classList.remove('dark');
                document.body.style.backgroundColor = 'white';
                document.body.style.color = 'black';
                statusDiv.innerHTML = '<span class="success">‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞</span>';
            } else {
                document.documentElement.classList.add('dark');
                document.body.style.backgroundColor = '#1f2937';
                document.body.style.color = 'white';
                statusDiv.innerHTML = '<span class="success">üåô –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞</span>';
            }
        }
        
        // –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function() {
            showDeviceInfo();
            testAPI();
        };
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ —ç–∫—Ä–∞–Ω–∞
        window.addEventListener('resize', showDeviceInfo);
    </script>
</body>
</html> 